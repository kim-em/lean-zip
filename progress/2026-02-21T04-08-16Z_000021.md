# 2026-02-21: Implementation — prove fromLengths_hasLeaf + fromLengths_leaf_spec

**Type**: implementation
**Phase**: Phase 3 (verified decompressor) — in progress
**Sorry count**: 4 → 2
**Commits**: `6765cf5`..`c8201d0`

**Key results**: Proved both directions of the tree–spec correspondence:

- **`fromLengths_hasLeaf`** (forward): every `allCodes` entry → `TreeHasLeaf`
- **`fromLengths_leaf_spec`** (backward): every `TreeHasLeaf` → `allCodes` entry

These close the Huffman layer of the correctness proof, connecting the
native `HuffTree.fromLengths` builder to the spec's canonical code table.

**New theorems**: `insertLoop_forward` (with NC, NoLeafOnPath, and
previous-symbol invariants), `insertLoop_backward` (with NC invariant),
`insert_go_complete'` (insert inversion without NoLeafOnPath),
`array_set_ne_u32`, `array_set_self_u32`, `codeFor_some`.

**Design decisions**:
- Added `hlen_bound : lengths.size ≤ UInt16.size` to `fromLengths_leaf_spec`,
  `decodeBits_eq_spec_decode`, `huffTree_decode_correct` for UInt16 conversion
- Used `insert_go_complete'` (no NoLeafOnPath) for backward direction to
  avoid maintaining hnlop invariant in `insertLoop_backward`

**Remaining sorries**: `inflate_correct`, `inflate_correct'` (top-level
stream correctness — requires block-level + LZ77 + loop correspondence)

**Lines**: +610 (net, across 3 files)
