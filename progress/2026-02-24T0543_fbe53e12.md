# Progress: Split HuffmanTheorems.lean

- **Date**: 2026-02-24T05:43 UTC
- **Session type**: Review (file organization)
- **Issue**: #143

## What was done

Split `Zip/Spec/HuffmanTheorems.lean` (757 lines) into two files:

1. **`Zip/Spec/HuffmanKraft.lean`** (365 lines): Kraft inequality
   infrastructure — `ncRec`, `kraftSumFrom`, conservation law,
   `ValidLengths` analysis, `nextCodes_plus_count_le` bridge theorem.

2. **`Zip/Spec/HuffmanTheorems.lean`** (374 lines): prefix-free proofs,
   injectivity (`codeFor_injective`), decode correctness
   (`decode_prefix_free`), `allCodes` properties.

3. **`ZipForStd/List.lean`** (31 lines): Extracted `foldl_add_init` and
   `foldl_count_init` as public lemmas in `List` namespace, candidates
   for upstreaming.

Updated doc comments in `Huffman.lean` and `HuffmanEncode.lean`, and
the source layout table in `.claude/CLAUDE.md`.

## Decisions

- Moved `nextCodes_plus_count_le` into HuffmanKraft (not HuffmanTheorems)
  since it depends entirely on Kraft infrastructure — cleaner dependency
  direction.
- Changed `private` → `protected` for definitions/lemmas that need
  cross-file access (`ncRec`, `ncRec_shift`, `nextCodes_eq_ncRec`,
  `countLengths_eq`, `validLengths_cons`).
- Proof simplification pass found nothing actionable — the `show ... from
  by omega` patterns are providing proof terms for `ite` reduction and
  are idiomatic.

## Verification

- `lake build` passes (144 jobs)
- `lake exe test` passes (all tests)
- Both files under 500 lines
- Sorry count unchanged: 8 (4 DeflateFixedCorrect, 2 DecodeCorrect,
  2 InflateCorrect)
- No theorem statements modified
