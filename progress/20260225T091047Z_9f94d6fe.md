# Fill trailer sorrys via endPos exactness (3→1 sorrys)

**Session**: 9f94d6fe (feature)
**Issue**: #286
**Branch**: agent/9f94d6fe

## What changed

Reduced sorry count from 3 to 1 by proving trailer byte match for both
gzip (CRC32 + ISIZE) and zlib (Adler32) roundtrip theorems.

### Key theorems added

**GzipCorrect.lean**:
- `alignToByte_pos_ge_of_toBits_short`: if `br.toBits.length < 8` then
  `br.alignToByte.pos ≥ br.data.size` — the bit reader has consumed all
  complete bytes
- `inflateRaw_endPos_ge` / `inflateRaw_endPos_eq`: endPos = prefix.size +
  deflated.size (endPos_ge is the remaining sorry)
- `compress_trailer` / `compress_crc32` / `compress_isize`: trailer byte
  roundtrip theorems using `readUInt32LE_append3_right` and `readUInt32LE_bytes`

**ZlibCorrect.lean**:
- `compress_trailer` / `compress_adler32`: same pattern but big-endian
  using `readUInt32BE_append_right` and `readUInt32BE_bytes`
- Restructured main proof to extract endPos exactness to outer scope

### Sorrys filled
- `hcrc` in `gzip_decompressSingle_compress` (CRC32 trailer match)
- `hisize` in `gzip_decompressSingle_compress` (ISIZE trailer match)
- `hadler` in `zlib_decompressSingle_compress` (Adler32 trailer match)

### Remaining sorry (1)
- `inflateRaw_endPos_ge`: needs `inflateLoop_complete` to expose that the
  final BitReader has `toBits.length < 8` (i.e., DEFLATE padding < 8 bits).
  The `alignToByte_pos_ge_of_toBits_short` lemma is ready to use once
  this information is available.

## Approach notes for future sessions

The root blocker is that `inflateLoop_complete` (in InflateComplete.lean)
internally tracks `br'.toBits = remaining_spec_bits` but only exposes
`∃ endPos` in its conclusion. To prove `inflateRaw_endPos_ge`, one needs
to either:
1. Strengthen `inflateLoop_complete` to also return `br'.toBits.length`
   or `br'.bitOff` information (complex — the theorem is ~250 lines)
2. Prove a separate theorem about DEFLATE bitstream padding properties
   that doesn't go through inflateLoop_complete

The `bitsToBytes` padding fact (`deflateFixed_spec` shows padding < 8 bits)
is available in DeflateFixedCorrect.lean but connecting it to the native
decoder's BitReader state requires the inflateLoop_complete strengthening.
