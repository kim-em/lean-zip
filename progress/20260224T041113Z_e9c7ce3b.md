# Progress: Upgrade toolchain to v4.29.0-rc2

- **Date**: 2026-02-24T04:11Z
- **Session**: e9c7ce3b (worker, review/toolchain)
- **Issue**: #133

## What was done

Upgraded Lean toolchain from v4.29.0-rc1 to v4.29.0-rc2.

## Changes required

Two categories of breakage, both minor:

### 1. `simp` now closes `Array.getElem_toList` goals (7 locations)

In rc1, `simp only [..., Array.getElem_toList]` would reduce
`data.data.toList[i]` to `data.data[i]` but leave the final
`data.data[i] = data[i]` step for `rfl`. In rc2, `simp` closes
the goal entirely, making the trailing `; rfl` cause "No goals
to be solved". Fix: remove the trailing `; rfl`.

Affected files: HuffmanCorrect (2), HuffmanEncodeCorrect (3),
DynamicTreesCorrect (1), DeflateDynamicCorrect (1).

Note: `BitstreamCorrect.lean` has similar `; rfl` patterns but
these still work on rc2 â€” the `rfl` there bridges `Array.getElem`
to `ByteArray.getElem` which is a different definitional step.

### 2. `n + 0` normalization breaks rewrite pattern (2 locations)

`getElem_pfx_hdr pfx hdr rest 0` produces a conclusion with
`[pfx.size + 0]`, but rc2 normalizes the goal's `pfx.size + 0`
to `pfx.size` before the rewrite fires. Added a specialized
`getElem_pfx_hdr_zero` lemma that states the result directly
with `[pfx.size]`.

Affected file: DeflateStoredCorrect (2 call sites).

## Verification

- `lake build`: passes (138 jobs, no errors)
- `lake exe test`: all tests pass
- Sorry count: 15 (unchanged)
- No theorem statements modified

## Sorry count

Before: 15, After: 15 (no change)
