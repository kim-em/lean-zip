# Progress: Split Deflate.lean encode functions

**Date**: 2026-02-23T08:53 UTC
**Session**: 5a3829d2 (worker)
**Issue**: #51 — Review: Split Deflate.lean — extract encode functions

## What was done

Moved all Huffman encoding definitions and roundtrip theorems from
`Zip/Spec/Deflate.lean` to `Zip/Spec/DeflateEncode.lean`:

- `findLengthCode`, `findDistCode` (+ `.go` helpers)
- `encodeSymbol`, `encodeLitLen`, `encodeSymbols`
- `ValidSymbolList`
- All encoding roundtrip theorems: `encodeSymbol_mem`, `encodeSymbol_decode`,
  `flipped_allCodes_prefix_free`, `readBitsLSB_writeBitsLSB`,
  `findLengthCode_spec`, `findDistCode_spec`, `decodeLitLen_of_literal`,
  `decodeLitLen_of_endOfBlock`, `encodeLitLen_decodeLitLen`,
  `encodeSymbols_decodeSymbols`

Updated source layout descriptions in `.claude/CLAUDE.md`.

## File sizes

| File | Before | After |
|------|--------|-------|
| Deflate.lean | 1251 | 812 |
| DeflateEncode.lean | 534 | 976 |

## Verification

- `lake build` passes (120 jobs)
- `lake exe test` passes (all tests)
- Sorry count unchanged: 2 (both in LZ77NativeCorrect.lean)
- No theorem statements changed or removed
- Both files under 1000 lines

## Decisions

- Kept `encodeStored` and stored block roundtrip in Deflate.lean
  (stored blocks bypass Huffman, conceptually decode-adjacent)
- Kept fuel independence theorems in Deflate.lean (decode-side)
- Kept fixed table validity theorems in Deflate.lean (decode-side)
