# Progress: Review DeflateSuffix.lean proof quality

**Date**: 2026-02-27 05:24 UTC
**Session**: 07d77d78 (review)
**Issue**: #313

## What was accomplished

Removed all 8 `set_option linter.unusedSimpArgs false` annotations from
`Zip/Spec/DeflateSuffix.lean` and fixed 3 additional linter warnings,
achieving zero warnings.

### Fix pattern

The `simp only [hX, bind, Option.bind]` pattern triggers a false-positive
linter warning because `bind` and `Option.bind` contribute only via dsimp
(definitional simplification), not as rewrite rules. The fix is a two-step
approach:

```lean
-- Before:
simp only [hX, bind, Option.bind] at h ⊢

-- After:
rw [hX] at h; dsimp only [bind, Option.bind] at h ⊢
```

`rw` handles the hypothesis rewrite, and `dsimp` handles the bind reduction
as separate steps. This avoids the linter warning while keeping proofs working.

### Additional cleanup

- Removed 6 dead `hlen_beq` bindings from `decodeDynamicTables_append` and
  `decodeDynamicTables_valid_both` (simp derives `(x == y) = true` from
  `x = y` directly)
- Dropped unused `decode.go` from `simp [decode.goR, decode.go]` in
  `decode_goR_fst`
- Removed unused `guard` from simp args in `decodeCLSymbols_append` (2 sites)
- Removed unused `↓reduceIte` from simp args in `decodeStored_append` (1 site)

## Key pattern discovered

The `rw [hX] at h; dsimp only [bind, Option.bind]` pattern is the correct
fix for the `Option` monad version of the bind/Except.bind pattern established
in #310 (DeflateStoredCorrect). The `Except` version uses `dsimp only [bind,
Except.bind]` directly because `Except.bind` unfolds differently. For `Option`,
`rw` is needed first to substitute the `some (...)` value before `dsimp` can
reduce the bind.

## Quality metrics

| Metric | Before | After |
|--------|--------|-------|
| Lines | 704 | 684 |
| Sorries | 0 | 0 |
| Linter suppressions | 8 | 0 |
| Linter warnings | 11+ | 0 |
| Theorem signatures | unchanged | unchanged |

## Decisions

- Used `rw + dsimp` rather than trying to make `simp only` work without
  the bind arguments. The `simp only [hX]` approach (dropping bind/Option.bind)
  fails because `simp only` with `only` does NOT have `Option.bind` in its
  internal dsimp lemma set.
